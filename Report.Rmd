---
title: "Assignment"
author: "Ellen Oosting"
date: "23 januari 2017"
output: html_document
---

```{r}
library(shiny)
library(leaflet)
shinyUI(fluidPage(
  titlePanel("First assignment Course 9 Data Products"),
  sidebarLayout(
    sidebarPanel(
      p("by Ellen Oosting"),
      p("Rated as:"),
      textOutput("text")
      ),
    mainPanel()
  ),
  mainPanel(
    h3("Welcome on this page"),
    p("What is your first impression?"),
    sliderInput("slider1","Scale from 1-10",1,10,8),
    p("Let's create a wave"),
    sliderInput("a","What is the shift horizontal of the wave?",min=0,max=5,step=0.5,value=0),
    sliderInput("b","What is the amplitude of the wave?",min=0,max=5,step=0.5,value=1),
    sliderInput("c","What is the period of the wave?",min=0,max=10,step=0.5,value=1),
    sliderInput("d","What is the startpoint of the wave?",min=0,max=10,step=0.5,value=0),
    h3("Your wave:"),
    p("Graph of the points"),
    plotOutput("plot1"),
    h2("My map"),
    tabsetPanel(type = "tabs",
                tabPanel("Los Angeles", br(), leafletOutput("losangeles")),
                tabPanel("New York", br(), leafletOutput("newyork")),
                tabPanel("Kansas", br(), leafletOutput("kansas"))
                )

  )
))
shinyServer(function(input,output){
  output$text<-renderText(input$slider1)
  
  output$a1<-renderText(input$a)
  output$b1<-renderText(input$b)
  output$c1<-renderText(input$c)
  output$d1<-renderText(input$d)
  library(ggplot2)
  x=seq(0,3.7*pi,0.001)
  
  output$plot1<-renderPlot({
    mi<-sin(x)
    ma<-input$a+input$b*sin(input$c*(x-input$d))
        plot(x,y=input$a+input$b*sin(input$c*(x-input$d)),xlab="x - value initial form 0-4 pi",
             ylab="y - value",main="The sinus function",col="blue",ylim=c(-10,10))
    lines(x,sin(x),col="red")
    legend("bottomleft",c("Your sinus","Original sinus"),col=c("blue","red"),lty = c(1,1), 
           lwd=c(2.5,2.5))
    })
  
  output$newyork<-renderLeaflet({
    leaflet() %>%
      addTiles() %>%
      addMarkers(lat=40.748817,lng=-73.985428)
  })
  
  output$losangeles<-renderLeaflet({
    leaflet() %>%
      addTiles() %>%
      addMarkers(lat=34.052235,lng=-118.243683)
  })
  
  output$kansas<-renderLeaflet({
    leaflet() %>%
      addTiles() %>%
      addMarkers(lat=37.697948,lng=-97.314835)
  })
})
```
